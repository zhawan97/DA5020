"0","library(class)"
"2"," 警告:   パッケージ ‘class’ はバージョン 4.3.3 の R の下で造られました "
"0","# knn function taking in training_data, testing_data, and k value to predict knn and return MSE"
"0","knn.predict <- function(data_train, data_test, k) {"
"0","  data_train_labels <- data_train[, ""tip_amount""]"
"0","  knn_prediction <- as.data.frame(knn(train = data_train, test = data_test,"
"0","                                      cl = data_train$tip_amount, k = k))"
"0","  "
"0","  # adding actual values to knn_prediction data frame"
"0","  knn_prediction$actual_val <- data_test$tip_amount"
"0","  "
"0","  # calculating squared error for each prediction"
"0","  knn_prediction$squared_error <- (knn_prediction$actual_val - as.numeric(knn_prediction[, 1])) ^ 2"
"0","  "
"0","  mean_squared_error <- mean(knn_prediction$squared_error)"
"0","  "
"0","  return(mean_squared_error) "
"0","}"
"0",""
"0",""
"0","# testing function with k = 3"
"0","mse_3 <- knn.predict(training_set, test_set, 3)"
"0","mse_3"
"1","[1]"
"1"," 24210.81"
"1","
"
