Sys.setLanguage("en")
install.packages("openintro")
ncbirths
library(openintro)
library(openintro)
data(ncbirths)
ncbirths
?data
?cor
View(ncbirths)
cor(ncbirths[c("fage","mage","mature","weeks","premie","visits","marital","gained","weight","lowbirthweight","gender","habit","whitemom")])
?cor_matrix
cor(ncbirths)
cor(ncbirths[c("fage","mage","weeks","visits","gained","weight")])
cor(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "complete.obs")
cor(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "pairwise.complete.obs")
pairs(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "pairwise.complete.obs")
# use =
cor(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "complete.obs")
pairs(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "complete.obs")
pairs(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "complete.obs")
?ncbirths
# use = complete.obs to remove NA values
cor(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "pairwise.complete.obs")
# Create paired correlation plots to visualize the data
pairs(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "pairwise.complete.obs")
pairs(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "pairwise.complete.obs")
pairs.panels(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "pairwise.complete.obs")
install.packages("psych")
pairs.panels(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "pairwise.complete.obs")
library(psych)
pairs.panels(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "pairwise.complete.obs")
# Load libraries and datasets
library(openintro)
library(psych)
library(dplyr)
data(ncbirths)
# Load libraries and datasets
library(openintro)
library(psych)
library(dplyr)
data(ncbirths)
ncbirths <- ncbirths %>%
mutate(premie_numeric = ifelse(premie = "premie", 0,1))
ncbirths <- ncbirths %>%
mutate(premie_numeric = ifelse(premie == "premie", 0,1))
# use = pairwise.complete.obs to remove NA values
cor(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "pairwise.complete.obs")
# Create paired correlation plots to visualize the data
pairs.panels(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "pairwise.complete.obs")
View(ncbirths)
ncbirths <- ncbirths %>%
mutate(premie_numeric = ifelse(premie == "premie", 0,1))
mutate(marital_numeric = ifelse(marital == "not married", 0,1))
ncbirths <- ncbirths %>%
mutate(premie_numeric = ifelse(premie == "premie", 0,1))
mutate(marital_numeric = ifelse(marital == "not married", 0,1))
ncbirths <- ncbirths %>%
mutate(premie_numeric = ifelse(premie == "premie", 0,1))
mutate(marital_numeric = ifelse(marital == "married", 1, 0))
ncbirths <- ncbirths %>%
mutate(premie_numeric = ifelse(premie == "premie", 0,1)) %>%
mutate(marital_numeric = ifelse(marital == "married", 1, 0))
# use = pairwise.complete.obs to remove NA values
cor(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "pairwise.complete.obs")
# Create paired correlation plots to visualize the data
pairs.panels(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "pairwise.complete.obs")
ncbirths <- ncbirths %>%
mutate(premie_numeric = ifelse(premie == "premie", 0,1)) %>%
mutate(marital_numeric = ifelse(marital == "married", 1, 0)) %>%
mutate(lowbirthweight_numeric = ifelse(lowbirthweight == "low", 1,0)) %>%
mutate(gender_numeric = ifelse(gender == "male", 1,0))
mutate(habit_numeric = ifelse(habit == "smoker", 1,0))
ncbirths <- ncbirths %>%
mutate(premie_numeric = ifelse(premie == "premie", 0,1)) %>%
mutate(marital_numeric = ifelse(marital == "married", 1, 0)) %>%
mutate(lowbirthweight_numeric = ifelse(lowbirthweight == "low", 1,0)) %>%
mutate(gender_numeric = ifelse(gender == "male", 1,0)) %>%
mutate(habit_numeric = ifelse(habit == "smoker", 1,0))
# use = pairwise.complete.obs to remove NA values
cor(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "pairwise.complete.obs")
# Create paired correlation plots to visualize the data
pairs.panels(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "pairwise.complete.obs")
ncbirths <- ncbirths %>%
mutate(premie_numeric = ifelse(premie == "premie", 0,1)) %>%
mutate(marital_numeric = ifelse(marital == "married", 1, 0)) %>%
mutate(lowbirthweight_numeric = ifelse(lowbirthweight == "low", 1,0)) %>%
mutate(gender_numeric = ifelse(gender == "male", 1,0)) %>%
mutate(habit_numeric = ifelse(habit == "smoker", 1,0)) %>%
mutate(whitemom_numeric = ifelse(whitemom == "white", 1,0))
# use = pairwise.complete.obs to remove NA values
cor(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "pairwise.complete.obs")
# Create paired correlation plots to visualize the data
pairs.panels(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "pairwise.complete.obs")
ncbirths <- ncbirths %>%
mutate(premie_numeric = ifelse(premie == "premie", 0,1)) %>%
mutate(mature_nuneric = ifelse(mature == "mature", 1,0)) %>%
mutate(marital_numeric = ifelse(marital == "married", 1, 0)) %>%
mutate(lowbirthweight_numeric = ifelse(lowbirthweight == "low", 1,0)) %>%
mutate(gender_numeric = ifelse(gender == "male", 1,0)) %>%
mutate(habit_numeric = ifelse(habit == "smoker", 1,0)) %>%
mutate(whitemom_numeric = ifelse(whitemom == "white", 1,0))
# use = pairwise.complete.obs to remove NA values
cor(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "pairwise.complete.obs")
# Create paired correlation plots to visualize the data
pairs.panels(ncbirths[c("fage","mage","weeks","visits","gained","weight")], use = "pairwise.complete.obs")
ncbirths <- ncbirths %>%
mutate(premie_numeric = ifelse(premie == "premie", 0,1)) %>%
mutate(mature_nuneric = ifelse(mature == "mature", 1,0)) %>%
mutate(marital_numeric = ifelse(marital == "married", 1, 0)) %>%
mutate(lowbirthweight_numeric = ifelse(lowbirthweight == "low", 1,0)) %>%
mutate(gender_numeric = ifelse(gender == "male", 1,0)) %>%
mutate(habit_numeric = ifelse(habit == "smoker", 1,0)) %>%
mutate(whitemom_numeric = ifelse(whitemom == "white", 1,0))
# use = pairwise.complete.obs to remove NA values
cor(ncbirths, use = "pairwise.complete.obs")
ncbirths <- ncbirths %>%
mutate(premie_numeric = ifelse(premie == "premie", 0,1)) %>%
mutate(mature_nuneric = ifelse(mature == "mature", 1,0)) %>%
mutate(marital_numeric = ifelse(marital == "married", 1, 0)) %>%
mutate(lowbirthweight_numeric = ifelse(lowbirthweight == "low", 1,0)) %>%
mutate(gender_numeric = ifelse(gender == "male", 1,0)) %>%
mutate(habit_numeric = ifelse(habit == "smoker", 1,0)) %>%
mutate(whitemom_numeric = ifelse(whitemom == "white", 1,0))
ncbirths_numeric <- ncbirths %>%
select(fage,mage,weeks,visits,gained,weight,premie_numeric,marital_numeric,mature_nuneric,lowbirthweight_numeric,gender_numeric,habit_numeric,whitemom_numeric)
# use = pairwise.complete.obs to remove NA values
cor(ncbirths_numeric, use = "pairwise.complete.obs")
# Create paired correlation plots to visualize the data
pairs.panels(ncbirths_numeric, use = "pairwise.complete.obs")
pairs.panels(ncbirths_numeric, use = "pairwise.complete.obs")
View(ncbirths_numeric)
m <- lm(weight ~ fage+mage+weeks+visits+gained+premie_numeric+marital_numeric+lowbirthweight_numeric+gender_numeric+habit_numeric+whitemom_numeric, data = ncbirths_numeric)
m <- lm(weight ~ fage+mage+weeks+visits+gained+premie_numeric+marital_numeric+lowbirthweight_numeric+gender_numeric+habit_numeric+whitemom_numeric, data = ncbirths_numeric)
print(m)
m <- lm(weight ~ fage+mage+weeks+visits+gained+premie_numeric+marital_numeric+lowbirthweight_numeric+gender_numeric+habit_numeric+whitemom_numeric, data = ncbirths_numeric)
summary(m)
m <- lm(weight ~ fage+mage+weeks+visits+gained+premie_numeric+marital_numeric+gender_numeric+habit_numeric+whitemom_numeric, data = ncbirths_numeric)
summary(m)
# Step 1
# Eliminate mage because it has the highest p-value of 0.79
m <- lm(weight ~ fage+weeks+visits+gained+premie_numeric+marital_numeric+gender_numeric+habit_numeric+whitemom_numeric, data = ncbirths_numeric)
# Step 1
# Eliminate mage because it has the highest p-value of 0.79
m <- lm(weight ~ fage+weeks+visits+gained+premie_numeric+marital_numeric+gender_numeric+habit_numeric+whitemom_numeric, data = ncbirths_numeric)
summary(m)
# Eliminate visits because of high p-value of 0.64
m <- lm(weight ~ fage+weeks+gained+premie_numeric+marital_numeric+gender_numeric+habit_numeric+whitemom_numeric, data = ncbirths_numeric)
summary(m)
# Eliminate fage because of high p-value of 0.23
m <- lm(weight ~ weeks+gained+premie_numeric+marital_numeric+gender_numeric+habit_numeric+whitemom_numeric, data = ncbirths_numeric)
summary(m)
# Eliminate gained because the coefficient is almost 0
m <- lm(weight ~ weeks+premie_numeric+marital_numeric+gender_numeric+habit_numeric+whitemom_numeric, data = ncbirths_numeric)
summary(m)
weight = -4.87+0.28(42)+0.008(22)+0.52(1)+0.24(1)+0.39(0)-0.38(0) + 0.22(1)
weight = -4.87+(0.28*42)+(0.008*22)+(0.52*1)+(0.24*1)+(0.39*0)-(0.38*0) + (0.22*1)
# Plug values into model
weight = -4.87+(0.28*42)+(0.008*22)+(0.52*1)+(0.24*1)+(0.39*0)-(0.38*0) + (0.22*1)
print(weight)
# CI calculation
top <- 8.046 + (1.96*1.064)
bot <- 8.046 - (1.96*1.064)
# Plug values into model
weight = -4.87+(0.28*42)+(0.008*22)+(0.52*1)+(0.24*1)+(0.39*0)-(0.38*0) + (0.22*1)
print(weight)
# CI calculation
top <- 8.046 + (1.96*1.064)
bot <- 8.046 - (1.96*1.064)
print(top)
print(bot)
summary(m)
mean(m)
m
summary(m)
# Extract coefficients
coeffs <- coeff(m)
# Extract coefficients
coeffs <- coef(m)
# Plug values into model
weight = -4.87+(0.28*42)+(0.008*22)+(0.52*1)+(0.24*1)+(0.39*0)-(0.38*0) + (0.22*1)
print(weight)
# PI calculation
top <- 8.046 + (1.96*1.064)
bot <- 8.046 - (1.96*1.064)
print(top)
print(bot)
# CI calculation using the mean
top <-
# Extract coefficients and calculate sample proportion
coeffs <- coef(m)
coeffs_sum <- coeffs[1]+coeffs[2]+coeffs[3]+coeffs[4]+coeffs[5]+coeffs[6]+coeffs[7]+coeffs[8]
sample_prop <- coeffs_sum / (1+coeffs_sum)
# Plug values into model
weight = -4.87+(0.28*42)+(0.008*22)+(0.52*1)+(0.24*1)+(0.39*0)-(0.38*0) + (0.22*1)
print(weight)
# PI calculation
top <- 8.046 + (1.96*1.064)
bot <- 8.046 - (1.96*1.064)
print(top)
print(bot)
# CI calculation using the mean
# Extract coefficients and calculate sample proportion
coeffs <- coef(m)
coeffs_sum <- coeffs[1]+coeffs[2]+coeffs[3]+coeffs[4]+coeffs[5]+coeffs[6]+coeffs[7]+coeffs[8]
sample_prop <- coeffs_sum / (1+coeffs_sum)
# Plug values into model
weight = -4.87+(0.28*42)+(0.008*22)+(0.52*1)+(0.24*1)+(0.39*0)-(0.38*0) + (0.22*1)
print(weight)
# PI calculation
top <- 8.046 + (1.96*1.064)
bot <- 8.046 - (1.96*1.064)
print(top)
print(bot)
# CI calculation using the sample proportion
top <- sample_prop + (1.96*1.064)
bot <- sample_prop - (1.96*1.064)
print(sample_prop)
print(top)
print(bot)
coeffs[1]
class(coeffs[1])
# Extract coefficients and calculate sample proportion
coeffs <- coef(m)
coeffs_sum <- coeffs[[1]]+coeffs[[2]]+coeffs[[3]]+coeffs[[4]]+coeffs[[5]]+coeffs[[6]]+coeffs[[7]]+coeffs[[8]]
# Extract coefficients and calculate sample proportion
coeffs <- coef(m)
coeffs_sum <- coeffs[[1]]+coeffs[[2]]+coeffs[[3]]+coeffs[[4]]+coeffs[[5]]+coeffs[[6]]+coeffs[[7]]
sample_prop <- coeffs_sum / (1+coeffs_sum)
# Plug values into model
weight = -4.87+(0.28*42)+(0.008*22)+(0.52*1)+(0.24*1)+(0.39*0)-(0.38*0) + (0.22*1)
print(weight)
# PI calculation
top <- 8.046 + (1.96*1.064)
bot <- 8.046 - (1.96*1.064)
print(top)
print(bot)
# CI calculation using the sample proportion
top <- sample_prop + (1.96*1.064)
bot <- sample_prop - (1.96*1.064)
print(sample_prop)
print(top)
print(bot)
coeffs[8]
coeffs[7]
# Extract mean from fitted model
fm <- fitted(m)
mean_m <- mean(fm)
# Plug values into model
weight = -4.87+(0.28*42)+(0.008*22)+(0.52*1)+(0.24*1)+(0.39*0)-(0.38*0) + (0.22*1)
print(weight)
# PI calculation
top <- 8.046 + (1.96*1.064)
bot <- 8.046 - (1.96*1.064)
print(top)
print(bot)
# CI calculation using the sample proportion
top <- sample_prop + (1.96*1.064)
bot <- sample_prop - (1.96*1.064)
print(sample_prop)
print(top)
print(bot)
# Extract mean from fitted model
fm <- fitted(m)
mean_m <- mean(fm)
# Plug values into model
weight = -4.87+(0.28*42)+(0.008*22)+(0.52*1)+(0.24*1)+(0.39*0)-(0.38*0) + (0.22*1)
print(weight)
# PI calculation
top <- 8.046 + (1.96*1.064)
bot <- 8.046 - (1.96*1.064)
print(top)
print(bot)
# CI calculation using the mean
top <- mean + (1.96*1.064)
# Extract mean from fitted model
fm <- fitted(m)
mean_m <- mean(fm)
# Plug values into model
weight = -4.87+(0.28*42)+(0.008*22)+(0.52*1)+(0.24*1)+(0.39*0)-(0.38*0) + (0.22*1)
print(weight)
# PI calculation
top <- 8.046 + (1.96*1.064)
bot <- 8.046 - (1.96*1.064)
print(top)
print(bot)
# CI calculation using the mean
top <- mean_m + (1.96*1.064)
bot <- mean_m - (1.96*1.064)
print(mean_m)
print(top)
print(bot)
# Load libraries and datasets
library(openintro)
library(psych)
library(dplyr)
data(ncbirths)
ncbirths <- ncbirths %>%
mutate(premie_numeric = ifelse(premie == "premie", 0,1)) %>% # fullterm = 1
mutate(mature_nuneric = ifelse(mature == "mature", 1,0)) %>% # mature = 1
mutate(marital_numeric = ifelse(marital == "married", 1, 0)) %>% # married = 1
mutate(lowbirthweight_numeric = ifelse(lowbirthweight == "low", 1,0)) %>% # low = 1
mutate(gender_numeric = ifelse(gender == "male", 1,0)) %>% # male = 1
mutate(habit_numeric = ifelse(habit == "smoker", 1,0)) %>% # smoker = 1
mutate(whitemom_numeric = ifelse(whitemom == "white", 1,0)) # whitemom = 1
ncbirths_numeric <- ncbirths %>%
select(fage,mage,weeks,visits,gained,weight,premie_numeric,marital_numeric,mature_nuneric,lowbirthweight_numeric,gender_numeric,habit_numeric,whitemom_numeric)
# use = pairwise.complete.obs to remove NA values
cor(ncbirths_numeric, use = "pairwise.complete.obs")
# Create paired correlation plots to visualize the data
pairs.panels(ncbirths_numeric, use = "pairwise.complete.obs")
m <- lm(weight ~ fage+mage+weeks+visits+gained+premie_numeric+marital_numeric+gender_numeric+habit_numeric+whitemom_numeric, data = ncbirths_numeric)
summary(m)
# Eliminate mage because it has the highest p-value of 0.79
m <- lm(weight ~ fage+weeks+visits+gained+premie_numeric+marital_numeric+gender_numeric+habit_numeric+whitemom_numeric, data = ncbirths_numeric)
summary(m)
# Eliminate visits because of high p-value of 0.64
m <- lm(weight ~ fage+weeks+gained+premie_numeric+marital_numeric+gender_numeric+habit_numeric+whitemom_numeric, data = ncbirths_numeric)
summary(m)
# Eliminate fage because of high p-value of 0.23
m <- lm(weight ~ weeks+gained+premie_numeric+marital_numeric+gender_numeric+habit_numeric+whitemom_numeric, data = ncbirths_numeric)
summary(m)
# Extract mean from fitted model
fm <- fitted(m)
mean_m <- mean(fm)
# Plug values into model
weight = -4.87+(0.28*42)+(0.008*22)+(0.52*1)+(0.24*1)+(0.39*0)-(0.38*0) + (0.22*1)
print(weight)
# PI calculation
top <- 8.046 + (1.96*1.064)
bot <- 8.046 - (1.96*1.064)
print(top)
print(bot)
# CI calculation using the mean
top <- mean_m + (1.96*1.064)
bot <- mean_m - (1.96*1.064)
print(mean_m)
print(top)
print(bot)
